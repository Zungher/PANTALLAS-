<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8">
 <meta http-equiv="refresh" content="300">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Panel Informativo Mejorado</title>

 <!-- Leaflet CSS para el mapa -->
 <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

 <style>
   body {
     margin: 0;
     font-family: Arial, sans-serif;
     display: flex;
     flex-direction: column;
     height: 100vh;
     background-color: #000;
   }

   .section {
     border: 2px solid #000;
     box-sizing: border-box;
     overflow: hidden;
     display: flex;
     justify-content: center;
     align-items: center;
     padding: 0;
   }

   .vuelos {
     flex: 1;
   }

   .mapa {
     flex: 1;
   }

   .clima {
     flex: 1.2;
   }

   iframe {
     width: 100%;
     height: 100%;
     border: none;
   }

   #map {
     width: 100%;
     height: 100%;
   }

   /* ==================== Panel de Clima (Mejorado) ==================== */
   .weather-container {
     position: relative;
     width: 100%;
     height: 100%;
     color: #fff;
     display: flex;
     flex-direction: column;
     justify-content: space-between;
     padding: 20px;
     box-sizing: border-box;
     background-size: cover;
     background-position: center;
     background-repeat: no-repeat;
     transition: background-image 0.5s ease-in-out;
   }

   .weather-container::before {
     content: "";
     position: absolute;
     top: 0;
     left: 0;
     width: 100%;
     height: 100%;
     background: linear-gradient(to bottom, rgba(0,0,0,0.5), rgba(0,0,0,0.2));
     z-index: 1;
   }

   .weather-main, .forecast {
     position: relative;
     z-index: 2;
   }

   .weather-main {
     text-align: center;
     flex: 1;
     display: flex;
     flex-direction: column;
     justify-content: center;
     padding: 20px 0;
   }

   .city {
     font-size: 3vw;
     font-weight: bold;
     margin-bottom: 10px;
   }

   .temp {
     font-size: 6vw;
     margin: 10px 0;
     font-weight: 300;
   }

   .condition {
     font-size: 2vw;
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 10px;
     margin-bottom: 10px;
   }

   .details {
     display: flex;
     justify-content: center;
     gap: 2vw;
     margin-top: 20px;
     font-size: 1.5vw;
     flex-wrap: wrap;
   }

   .forecast {
     background-color: rgba(0,0,0,0.3);
     backdrop-filter: blur(5px);
     padding: 10px;
     border-radius: 8px;
     display: flex;
     justify-content: space-around;
     flex-wrap: wrap;
     margin-top: 20px;
   }

   .forecast-hour {
     text-align: center;
     flex: 1;
     min-width: 80px;
     font-size: 1.2vw;
     color: #fff;
     margin: 5px;
   }

   .forecast-hour img {
     width: 48px;
     height: 48px;
     margin: 8px 0;
   }
 </style>
</head>

<body>

 <!-- Secci√≥n 1: Vuelos -->
 <div class="section vuelos">
   <iframe src="https://vuelosrepo-git-main-zunghers-projects.vercel.app/"></iframe>
 </div>

 <!-- Secci√≥n 2: Mapa din√°mico -->
 <div class="section mapa">
   <div id="map"></div>
 </div>

 <!-- Secci√≥n 3: Clima din√°mico con imagen de fondo -->
 <div class="section clima">
   <div class="weather-container" id="weather-container">
     <div class="weather-main">
       <div class="city" id="city">Guatemala</div>
       <div class="temp" id="current-temp">--¬∞C</div>
       <div class="condition">
         <div id="weather-icon">‚òÅÔ∏è</div>
         <div id="description">Cargando...</div>
       </div>
       <div class="details">
         <div id="wind">üí® -- km/h</div>
         <div id="humidity">üíß --%</div>
         <div id="pressure">‚è≤Ô∏è -- hPa</div>
       </div>
     </div>

     <div class="forecast" id="forecast-container">
       <div class="forecast-hour">
         <div>08:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>6¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>09:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163624.png" alt="rain">
         <div>5¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>10:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>5¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>11:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>6¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>12:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163624.png" alt="rain">
         <div>7¬∞C</div>
       </div>
     </div>
   </div>
 </div>

 <!-- Scripts -->
 <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

 <script>
   // Mapa din√°mico con Leaflet.js
   const hotelLatLng = [14.6094, -90.5186];
   const aeropuertoLatLng = [14.5833, -90.5270];

   const map = L.map('map').setView([14.596, -90.523], 14);

   L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
     attribution: '&copy; OpenStreetMap contributors'
   }).addTo(map);

   L.marker(hotelLatLng).addTo(map)
     .bindPopup('<b>Hotel Barcel√≥ Guatemala City</b>').openPopup();

   L.marker(aeropuertoLatLng).addTo(map)
     .bindPopup('<b>Aeropuerto La Aurora</b>');

   const ruta = L.polyline([hotelLatLng, aeropuertoLatLng], {
     color: 'red',
     weight: 5
   }).addTo(map);

   map.fitBounds(ruta.getBounds());

   // Clima din√°mico con fondo de imagen
   async function cargarClima() {
     try {
       const res = await fetch('https://clima-git-main-zunghers-projects.vercel.app/');
       const data = await res.json();

       document.getElementById('city').innerText = "Guatemala";
       document.getElementById('current-temp').innerText = data.temperatura || '--¬∞C';
       document.getElementById('description').innerText = data.estado || 'Sin datos';
       document.getElementById('wind').innerText = `üí® ${data.viento || '-- km/h'}`;
       document.getElementById('humidity').innerText = `üíß 80%`;
       document.getElementById('pressure').innerText = `‚è≤Ô∏è 1012 hPa`;

       const estado = (data.estado || '').toLowerCase();
       let icono = '‚ùì';
       let bgImage = 'url("https://aprende.guatemala.com/wp-content/uploads/2020/06/climas-en-guatemala.jpg")'; // Imagen por defecto

       if (estado.includes('despejado')) {
         icono = '‚òÄÔ∏è';
         bgImage = 'url("https://media.istockphoto.com/id/824800468/es/foto/sol-en-el-cielo-azul-con-nubes.jpg")';
       } else if (estado.includes('nublado')) {
         icono = '‚òÅÔ∏è';
         bgImage = 'url("https://media.istockphoto.com/id/1156241578/es/foto/cielo-oscuro-con-nubes-de-tormenta.jpg")';
       } else if (estado.includes('lluvia')) {
         icono = 'üåßÔ∏è';
         bgImage = 'url("https://media.istockphoto.com/id/1429701799/es/foto/gotas-de-lluvia-sobre-asfalto-lluvia-clima-lluvioso-aguacero.jpg")';
       } else if (estado.includes('chubasco')) {
         icono = 'üå¶Ô∏è';
         bgImage = 'url("https://cdn0.ecologiaverde.com/es/posts/1/7/6/que_son_los_chubascos_4671_0_600.jpg")';
       } else if (estado.includes('niebla')) {
         icono = 'üå´Ô∏è';
         bgImage = 'url("https://fotografias.larazon.es/clipping/cmsimages01/2023/12/02/C23C7773-C437-4B86-93D6-7A41E43D3BF2/que-niebla-cuales-son-sus-tipos_98.jpg")';
       }

       document.getElementById('weather-icon').innerText = icono;
       const weatherContainer = document.getElementById('weather-container');
       weatherContainer.style.backgroundImage = bgImage;

     } catch (error) {
       console.error('Error al cargar el clima', error);
     }
   }

   cargarClima();
 </script>

</body>
</html>
