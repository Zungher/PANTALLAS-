<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8">
 <meta http-equiv="refresh" content="300">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Panel Informativo Mejorado</title>

 <!-- Leaflet CSS para el mapa -->
 <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

 <style>
   body {
     margin: 0;
     font-family: Arial, sans-serif;
     display: flex;
     flex-direction: column;
     height: 100vh;
     background-color: #000;
   }

   .section {
     border: 2px solid #000;
     box-sizing: border-box;
     overflow: hidden;
     display: flex;
     flex-direction: column;
     padding: 0;
     height: 100%;
     width: 100%;
   }

   .vuelos {
     flex: 1;
   }

   .mapa {
     flex: 1;
   }

   .clima {
     flex: 1.2;
   }

   iframe {
     width: 100%;
     height: 100%;
     border: none;
   }

   #map {
     width: 100%;
     height: 100%;
   }

   /* Estilo del clima */
   .weather-container {
     width: 100%;
     height: 100%;
     background-color: #607d8b;
     color: #fff;
     display: flex;
     flex-direction: column;
     justify-content: space-between;
     align-items: center;
     box-sizing: border-box;
     padding: 2vh;
   }

   .weather-main {
     text-align: center;
     flex-grow: 1;
     display: flex;
     flex-direction: column;
     justify-content: center;
   }

   .city {
     font-size: 3.5vh;
     font-weight: bold;
   }

   .temp {
     font-size: 8vh;
     margin: 2vh 0;
   }

   .condition {
     font-size: 3vh;
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 1vh;
   }

   .details {
     display: flex;
     justify-content: center;
     gap: 4vw;
     margin-top: 2vh;
     font-size: 2vh;
   }

   .forecast {
     width: 100%;
     background-color: rgba(0,0,0,0.2);
     padding: 1vh;
     display: flex;
     justify-content: space-around;
     flex-wrap: wrap;
     box-sizing: border-box;
   }

   .forecast-hour {
     text-align: center;
     flex: 1;
     min-width: 80px;
     font-size: 1.8vh;
     color: #fff;
   }

   .forecast-hour img {
     width: 48px;
     height: 48px;
   }
 </style>
</head>
<body>

 <!-- Secci√≥n 1: Vuelos -->
 <div class="section vuelos">
   <iframe src="https://vuelosrepo-git-main-zunghers-projects.vercel.app/"></iframe>
 </div>

 <!-- Secci√≥n 2: Mapa din√°mico -->
 <div class="section mapa">
   <div id="map"></div>
 </div>

 <!-- Secci√≥n 3: Clima din√°mico mejorado -->
 <div class="section clima">
   <div class="weather-container" id="weather-container">
     <div class="weather-main">
       <div class="city" id="city">Guatemala</div>
       <div class="temp" id="current-temp">--¬∞C</div>
       <div class="condition">
         <div id="weather-icon">‚òÅÔ∏è</div>
         <div id="description">Cargando...</div>
       </div>
       <div class="details">
         <div id="wind">üí® -- km/h</div>
         <div id="humidity">üíß --%</div>
         <div id="pressure">‚è≤Ô∏è -- hPa</div>
       </div>
     </div>

     <div class="forecast" id="forecast-container">
       <div class="forecast-hour">
         <div>08:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>6¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>09:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163624.png" alt="rain">
         <div>5¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>10:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>5¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>11:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163661.png" alt="cloudy">
         <div>6¬∞C</div>
       </div>
       <div class="forecast-hour">
         <div>12:00</div>
         <img src="https://cdn-icons-png.flaticon.com/512/1163/1163624.png" alt="rain">
         <div>7¬∞C</div>
       </div>
     </div>
   </div>
 </div>

 <!-- Scripts -->
 <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

 <script>
   // Mapa din√°mico con Leaflet.js
   const hotelLatLng = [14.6094, -90.5186];
   const aeropuertoLatLng = [14.5833, -90.5270];

   const map = L.map('map').setView([14.596, -90.523], 14);

   L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
     attribution: '&copy; OpenStreetMap contributors'
   }).addTo(map);

   L.marker(hotelLatLng).addTo(map)
     .bindPopup('<b>Hotel Barcel√≥ Guatemala City</b>').openPopup();

   L.marker(aeropuertoLatLng).addTo(map)
     .bindPopup('<b>Aeropuerto La Aurora</b>');

   const ruta = L.polyline([hotelLatLng, aeropuertoLatLng], {
     color: 'red',
     weight: 5
   }).addTo(map);

   map.fitBounds(ruta.getBounds());

   // Clima din√°mico
   async function cargarClima() {
     try {
       const res = await fetch('https://clima-git-main-zunghers-projects.vercel.app/');
       const data = await res.json();

       document.getElementById('city').innerText = "Guatemala";
       document.getElementById('current-temp').innerText = data.temperatura || '--¬∞C';
       document.getElementById('description').innerText = data.estado || 'Sin datos';
       document.getElementById('wind').innerText = `üí® ${data.viento || '-- km/h'}`;
       document.getElementById('humidity').innerText = `üíß 80%`;
       document.getElementById('pressure').innerText = `‚è≤Ô∏è 1012 hPa`;

       const estado = (data.estado || '').toLowerCase();
       let icono = '‚ùì';
       let bgColor = '#607d8b';

       if (estado.includes('despejado')) {
         icono = '‚òÄÔ∏è';
         bgColor = '#fbc02d';
       } else if (estado.includes('nublado')) {
         icono = '‚òÅÔ∏è';
         bgColor = '#90a4ae';
       } else if (estado.includes('lluvia')) {
         icono = 'üåßÔ∏è';
         bgColor = '#546e7a';
       }

       document.getElementById('weather-icon').innerText = icono;
       document.getElementById('weather-container').style.backgroundColor = bgColor;

     } catch (error) {
       console.error('Error al cargar el clima', error);
     }
   }

   cargarClima();
 </script>

</body>
</html>
